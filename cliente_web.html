<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Sistema de Precios Din√°micos - Reservas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/static/styles.css" rel="stylesheet">
    <style>
        /* Forzar que solo se muestre una pesta√±a a la vez */
        .tab-pane:not(.show) {
            display: none !important;
        }
        .tab-pane.show {
            display: block !important;
        }
        
        /* Asegurar que las pesta√±as inactivas est√©n completamente ocultas */
        .tab-pane:not(.show.active) {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        /* Asegurar que solo la pesta√±a activa sea visible */
        .tab-pane.show.active {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            left: auto !important;
        }
        
        /* ‚úÖ Estilos para el modal de precios - UX mejorado */
        #nuevoPrecioModal {
            z-index: 9999 !important;
        }
        
        #nuevoPrecioModal .modal-dialog {
            z-index: 10000 !important;
            margin: 1.75rem auto !important;
        }
        
        #nuevoPrecioModal .modal-content {
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
            border: none !important;
            border-radius: 0.5rem !important;
        }
        
        .modal-backdrop {
            z-index: 9998 !important;
        }
        
        /* ‚úÖ Asegurar que los botones del footer sean visibles */
        #nuevoPrecioModal .modal-footer {
            border-top: 1px solid #dee2e6 !important;
            padding: 1rem !important;
            background: #f8f9fa !important;
        }
        
        #nuevoPrecioModal .modal-footer .btn {
            margin-left: 0.5rem !important;
            min-width: 120px !important;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <!-- Header -->
        <header class="bg-primary text-white py-4 mb-4">
            <div class="container">
                <h1 class="display-4">
                    <i class="fas fa-chart-line me-3"></i>
                    Sistema de Precios Din√°micos
                </h1>
                <p class="lead">Gesti√≥n inteligente de precios para reservas</p>
                <div class="alert alert-info">
                    <strong>üåê Conectado a:</strong> <span id="apiStatus">Verificando conexi√≥n...</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="container">
            <!-- Navigation Tabs -->
            <ul class="nav nav-tabs mb-4" id="mainTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard"
                        type="button" role="tab">
                        <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="calculator-tab" data-bs-toggle="tab" data-bs-target="#calculator"
                        type="button" role="tab">
                        <i class="fas fa-calculator me-2"></i>Calculadora
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#history"
                        type="button" role="tab">
                        <i class="fas fa-history me-2"></i>Historial
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="quick-rules-tab" data-bs-toggle="tab" data-bs-target="#quick-rules"
                        type="button" role="tab">
                        <i class="fas fa-cogs me-2"></i>Gesti√≥n de Reglas
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="notifications-tab" data-bs-toggle="tab" data-bs-target="#notifications"
                        type="button" role="tab">
                        <i class="fas fa-bell me-2"></i>Notificaciones
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reservas-tab" data-bs-toggle="tab" data-bs-target="#reservas" type="button" role="tab">
                        <i class="fas fa-calendar-check me-2"></i>Gesti√≥n de Reservas
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="calendario-tab" data-bs-toggle="tab" data-bs-target="#calendario" type="button" role="tab">
                        <i class="fas fa-calendar-alt me-2"></i>Calendario
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="services-tab" data-bs-toggle="tab" data-bs-target="#services"
                        type="button" role="tab">
                        <i class="fas fa-concierge-bell me-2"></i>Gesti√≥n Servicios
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="resources-tab" data-bs-toggle="tab" data-bs-target="#resources"
                        type="button" role="tab">
                        <i class="fas fa-building me-2"></i>Gesti√≥n Recursos
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pagos-tab" data-bs-toggle="tab" data-bs-target="#pagos" type="button" role="tab" aria-controls="pagos" aria-selected="false">
                        üí≥ Pagos
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="integraciones-tab" data-bs-toggle="tab" data-bs-target="#integraciones" type="button" role="tab" aria-controls="integraciones" aria-selected="false">
                        üîó Integraciones
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="precios-tab" data-bs-toggle="tab" data-bs-target="#precios" type="button" role="tab" aria-controls="precios" aria-selected="false">
                        üí∞ Precios
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="mainTabsContent">
                <!-- Dashboard Tab -->
                <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6 col-lg-3 mb-4">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title">Total Reglas</h4>
                                            <h2 id="totalRules">-</h2>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-cogs fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-4">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title">Reglas Activas</h4>
                                            <h2 id="activeRules">-</h2>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-check-circle fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-4">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title">Servicios</h4>
                                            <h2 id="totalServices">-</h2>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-concierge-bell fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-4">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="card-title">Recursos</h4>
                                            <h2 id="totalResources">-</h2>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-building fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5><i class="fas fa-list me-2"></i>Reglas Recientes</h5>
                                    <div>
                                        <button class="btn btn-outline-primary btn-sm me-2"
                                            onclick="app.exportDashboardStats()">
                                            <i class="fas fa-download me-2"></i>Exportar Stats
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="recentRulesList" class="list-group">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Cargando reglas...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calculator Tab -->
                <div class="tab-pane fade" id="calculator" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-calculator me-2"></i>Calculadora de Precios</h5>
                                </div>
                                <div class="card-body">
                                    <form id="priceCalculatorForm">
                                        <div class="mb-3">
                                            <label for="calcService" class="form-label">Servicio</label>
                                            <select class="form-select" id="calcService" required>
                                                <option value="">Seleccionar servicio...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calcResource" class="form-label">Recurso</label>
                                            <select class="form-select" id="calcResource" required>
                                                <option value="">Seleccionar recurso...</option>
                                            </select>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="calcDate" class="form-label">Fecha</label>
                                                    <input type="date" class="form-control" id="calcDate" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="calcTime" class="form-label">Hora</label>
                                                    <input type="time" class="form-control" id="calcTime" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="calcDuration" class="form-label">Duraci√≥n</label>
                                                    <div class="input-group">
                                                        <input type="number" class="form-control" id="calcDuration"
                                                            value="1" min="1" max="168" step="1" required>
                                                        <select class="form-select" id="calcDurationUnit"
                                                            style="max-width: 120px;">
                                                            <option value="hours">Horas</option>
                                                            <option value="days">D√≠as</option>
                                                            <option value="nights">Noches</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-text text-muted" id="durationHelp">
                                                        Selecciona un servicio para ver las opciones de duraci√≥n
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="calcParticipants"
                                                        class="form-label">Participantes</label>
                                                    <input type="number" class="form-control" id="calcParticipants"
                                                        value="1" min="1" max="100" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calcClientType" class="form-label">Tipo de Cliente</label>
                                            <select class="form-select" id="calcClientType">
                                                <option value="regular">Regular</option>
                                                <option value="vip">VIP</option>
                                                <option value="premium">Premium</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100">
                                            <i class="fas fa-calculator me-2"></i>Calcular Precio
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-receipt me-2"></i>Resultado del C√°lculo</h5>
                                </div>
                                <div class="card-body" id="calculationResult">
                                    <div class="text-center text-muted">
                                        <i class="fas fa-calculator fa-3x mb-3"></i>
                                        <p>Ingresa los datos y calcula el precio din√°mico</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Tab -->
                <div class="tab-pane fade" id="history" role="tabpanel">
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5><i class="fas fa-history me-2"></i>Historial de C√°lculos</h5>
                                    <div>
                                        <button class="btn btn-outline-primary btn-sm me-2"
                                            onclick="app.exportHistoryToCSV()">
                                            <i class="fas fa-download me-2"></i>Exportar CSV
                                        </button>
                                        <button class="btn btn-outline-danger btn-sm" onclick="app.clearHistory()">
                                            <i class="fas fa-trash me-2"></i>Limpiar Historial
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="historyContainer" class="list-group">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-history fa-2x mb-3"></i>
                                            <p>No hay c√°lculos en el historial</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gesti√≥n de Reglas Tab -->
                <div class="tab-pane fade" id="quick-rules" role="tabpanel">
                    <h3 class="mb-4"><i class="fas fa-cogs me-2"></i>Gesti√≥n de Reglas de Precios</h3>

                    <!-- Lista de Reglas Existentes -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div
                                    class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                                    <h5><i class="fas fa-list me-2"></i>Reglas Existentes</h5>
                                    <button class="btn btn-light btn-sm" onclick="app.refreshRulesList()">
                                        <i class="fas fa-sync-alt me-2"></i>Actualizar
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div id="rulesListContainer">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Cargando reglas...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h4 class="mb-3"><i class="fas fa-plus me-2"></i>Crear Nuevas Reglas</h4>

                    <div class="row">
                        <!-- Hora Pico -->
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header bg-warning text-dark">
                                    <h5><i class="fas fa-clock me-2"></i>Regla de Hora Pico</h5>
                                </div>
                                <div class="card-body">
                                    <form id="horaPicoForm">
                                        <div class="mb-3">
                                            <label for="hpName" class="form-label">Nombre de la Regla</label>
                                            <input type="text" class="form-control" id="hpName"
                                                placeholder="Ej: Hora Pico Tarde" required>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="hpStartTime" class="form-label">Hora Inicio</label>
                                                    <input type="time" class="form-control" id="hpStartTime"
                                                        value="17:00" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="hpEndTime" class="form-label">Hora Fin</label>
                                                    <input type="time" class="form-control" id="hpEndTime" value="20:00"
                                                        required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="hpRecargo" class="form-label">Porcentaje de Recargo</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="hpRecargo" value="25"
                                                    min="0" max="100" step="0.1" required>
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">D√≠as de la Semana</label>
                                            <div class="row">
                                                <div class="col-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpLunes"
                                                            checked>
                                                        <label class="form-check-label" for="hpLunes">Lunes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpMartes"
                                                            checked>
                                                        <label class="form-check-label" for="hpMartes">Martes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpMiercoles"
                                                            checked>
                                                        <label class="form-check-label"
                                                            for="hpMiercoles">Mi√©rcoles</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpJueves"
                                                            checked>
                                                        <label class="form-check-label" for="hpJueves">Jueves</label>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpViernes"
                                                            checked>
                                                        <label class="form-check-label" for="hpViernes">Viernes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpSabado">
                                                        <label class="form-check-label" for="hpSabado">S√°bado</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hpDomingo">
                                                        <label class="form-check-label" for="hpDomingo">Domingo</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-warning w-100">
                                            <i class="fas fa-bolt me-2"></i>Crear Regla Hora Pico
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Descuento por Anticipaci√≥n -->
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5><i class="fas fa-calendar-check me-2"></i>Descuento por Anticipaci√≥n</h5>
                                </div>
                                <div class="card-body">
                                    <form id="anticipacionForm">
                                        <div class="mb-3">
                                            <label for="antName" class="form-label">Nombre de la Regla</label>
                                            <input type="text" class="form-control" id="antName"
                                                placeholder="Ej: Descuento Reserva Anticipada" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="antDias" class="form-label">D√≠as M√≠nimos de Anticipaci√≥n</label>
                                            <input type="number" class="form-control" id="antDias" value="7" min="1"
                                                max="365" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="antDescuento" class="form-label">Porcentaje de Descuento</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="antDescuento" value="15"
                                                    min="0" max="100" step="0.1" required>
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-success w-100">
                                            <i class="fas fa-calendar-check me-2"></i>Crear Regla de Descuento
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Nueva Regla de Fin de Semana -->
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h5><i class="fas fa-calendar-week me-2"></i>Recargo Fin de Semana</h5>
                                </div>
                                <div class="card-body">
                                    <form id="finSemanaForm">
                                        <div class="mb-3">
                                            <label for="fsName" class="form-label">Nombre de la Regla</label>
                                            <input type="text" class="form-control" id="fsName"
                                                placeholder="Ej: Recargo Fin de Semana" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="fsRecargo" class="form-label">Porcentaje de Recargo</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="fsRecargo" value="30"
                                                    min="0" max="100" step="0.1" required>
                                                <span class="input-group-text">%</span>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Aplicar a:</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="fsSabado" checked>
                                                <label class="form-check-label" for="fsSabado">S√°bados</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="fsDomingo" checked>
                                                <label class="form-check-label" for="fsDomingo">Domingos</label>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-info w-100">
                                            <i class="fas fa-calendar-week me-2"></i>Crear Regla Fin de Semana
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications Tab -->
                <div class="tab-pane fade" id="notifications" role="tabpanel">
                    <h3 class="mb-4"><i class="fas fa-bell me-2"></i>Configuraci√≥n de Notificaciones</h3>

                    <div class="row">
                        <!-- Configuraci√≥n General -->
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h5><i class="fas fa-cog me-2"></i>Configuraci√≥n General</h5>
                                </div>
                                <div class="card-body">
                                    <form id="generalNotificationsForm">
                                        <div class="mb-3">
                                            <label class="form-label">Tipos de Notificaciones</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                    id="confirmationsEnabled" checked>
                                                <label class="form-check-label" for="confirmationsEnabled">
                                                    Confirmaciones autom√°ticas
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="remindersEnabled"
                                                    checked>
                                                <label class="form-check-label" for="remindersEnabled">
                                                    Recordatorios autom√°ticos
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="systemAlertsEnabled"
                                                    checked>
                                                <label class="form-check-label" for="systemAlertsEnabled">
                                                    Alertas del sistema
                                                </label>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="autoDismissTime" class="form-label">Auto-ocultar despu√©s de
                                                (segundos)</label>
                                            <select class="form-select" id="autoDismissTime">
                                                <option value="3000">3 segundos</option>
                                                <option value="5000" selected>5 segundos</option>
                                                <option value="10000">10 segundos</option>
                                                <option value="0">No auto-ocultar</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100">
                                            <i class="fas fa-save me-2"></i>Guardar Configuraci√≥n
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Recordatorios Programados -->
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5><i class="fas fa-clock me-2"></i>Recordatorios Programados</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <h6>Recordatorios Activos:</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-check text-success me-2"></i>Verificaci√≥n de salud del
                                                sistema (cada 30 min)</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Revisi√≥n de reglas (diario
                                                a las 9:00 AM)</li>
                                            <li><i class="fas fa-check text-success me-2"></i>Exportaci√≥n de datos
                                                (semanal los lunes)</li>
                                        </ul>
                                    </div>
                                    <div class="mb-3">
                                        <button class="btn btn-outline-success btn-sm me-2"
                                            onclick="app.testReminder()">
                                            <i class="fas fa-bell me-2"></i>Probar Recordatorio
                                        </button>
                                        <button class="btn btn-outline-warning btn-sm"
                                            onclick="app.clearAllReminders()">
                                            <i class="fas fa-times me-2"></i>Limpiar Recordatorios
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Historial de Notificaciones -->
                        <div class="col-md-8 mb-4">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h5><i class="fas fa-history me-2"></i>Historial de Notificaciones</h5>
                                </div>
                                <div class="card-body">
                                    <div id="notificationHistoryContainer">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-bell fa-2x mb-3"></i>
                                            <p>No hay notificaciones en el historial</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Estad√≠sticas de Notificaciones -->
                        <div class="col-md-4 mb-4">
                            <div class="card">
                                <div class="card-header bg-warning text-dark">
                                    <h5><i class="fas fa-chart-bar me-2"></i>Estad√≠sticas</h5>
                                </div>
                                <div class="card-body">
                                    <div class="text-center">
                                        <div class="mb-3">
                                            <h4 id="totalNotifications">0</h4>
                                            <small class="text-muted">Total Notificaciones</small>
                                        </div>
                                        <div class="mb-3">
                                            <h4 id="unreadNotifications">0</h4>
                                            <small class="text-muted">No Le√≠das</small>
                                        </div>
                                        <div class="mb-3">
                                            <h4 id="todayNotifications">0</h4>
                                            <small class="text-muted">Hoy</small>
                                        </div>
                                    </div>
                                    <button class="btn btn-outline-warning btn-sm w-100" onclick="app.markAllAsRead()">
                                        <i class="fas fa-check-double me-2"></i>Marcar Todas como Le√≠das
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Configuraci√≥n Avanzada -->
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="card">
                                <div class="card-header bg-dark text-white">
                                    <h5><i class="fas fa-sliders-h me-2"></i>Configuraci√≥n Avanzada</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="soundEnabled"
                                                    checked>
                                                <label class="form-check-label" for="soundEnabled">
                                                    Sonidos de notificaci√≥n
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                    id="desktopNotificationsEnabled">
                                                <label class="form-check-label" for="desktopNotificationsEnabled">
                                                    Notificaciones del escritorio
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                    id="priorityNotificationsEnabled" checked>
                                                <label class="form-check-label" for="priorityNotificationsEnabled">
                                                    Notificaciones prioritarias
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-md-6">
                                            <button class="btn btn-outline-primary btn-sm me-2"
                                                onclick="app.requestNotificationPermission()">
                                                <i class="fas fa-permission me-2"></i>Solicitar Permisos
                                            </button>
                                            <button class="btn btn-outline-secondary btn-sm"
                                                onclick="app.resetNotificationSettings()">
                                                <i class="fas fa-undo me-2"></i>Restablecer
                                            </button>
                                        </div>
                                        <div class="col-md-6 text-end">
                                            <button class="btn btn-success btn-sm"
                                                onclick="app.exportNotificationSettings()">
                                                <i class="fas fa-download me-2"></i>Exportar Configuraci√≥n
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Calendario -->
                <div class="tab-pane fade" id="calendario" role="tabpanel">
                    <div class="container-fluid">
                        <!-- Controles del Calendario -->
                        <div class="row mb-4">
                            <div class="col-md-8">
                                           <div class="btn-group" role="group">
               <button type="button" class="btn btn-outline-primary" id="btnVistaMensual">
                   <i class="fas fa-calendar me-2"></i>Mensual
               </button>
               <button type="button" class="btn btn-outline-primary" id="btnVistaSemanal">
                   <i class="fas fa-calendar-week me-2"></i>Semanal
               </button>
               <button type="button" class="btn btn-outline-primary" id="btnVistaDiaria">
                   <i class="fas fa-calendar-day me-2"></i>Diaria
               </button>
           </div>
                                <div class="btn-group ms-3" role="group">
                                    <button type="button" class="btn btn-outline-secondary" id="btnAnterior">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" id="btnHoy">Hoy</button>
                                    <button type="button" class="btn btn-outline-secondary" id="btnSiguiente">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                                <h4 class="d-inline-block ms-3" id="calendarioTitulo">Agosto 2025</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex justify-content-end">
                                    <select class="form-select me-2" id="filtroServicioCalendario" style="width: auto;">
                                        <option value="">Todos los servicios</option>
                                    </select>
                                    <select class="form-select me-2" id="filtroRecursoCalendario" style="width: auto;">
                                        <option value="">Todos los recursos</option>
                                    </select>
                                    <button class="btn btn-primary" id="btnActualizarCalendario">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- B√∫squeda Avanzada de Disponibilidad -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="fas fa-search me-2"></i>B√∫squeda Avanzada de Disponibilidad
                                            <button class="btn btn-sm btn-outline-secondary float-end" type="button" data-bs-toggle="collapse" data-bs-target="#busquedaAvanzada">
                                                <i class="fas fa-chevron-down"></i>
                                            </button>
                                        </h6>
                                    </div>
                                    <div class="collapse" id="busquedaAvanzada">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <label class="form-label">Servicio</label>
                                                    <select class="form-select" id="busquedaServicio">
                                                        <option value="">Seleccionar servicio</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-3">
                                                    <label class="form-label">Recurso</label>
                                                    <select class="form-select" id="busquedaRecurso">
                                                        <option value="">Seleccionar recurso</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="form-label">Fecha</label>
                                                    <input type="date" class="form-control" id="busquedaFecha">
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="form-label">Hora</label>
                                                    <input type="time" class="form-control" id="busquedaHora">
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="form-label">&nbsp;</label>
                                                    <button class="btn btn-primary w-100" id="btnBuscarDisponibilidad">
                                                        <i class="fas fa-search me-1"></i>Buscar
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="mt-3" id="resultadosDisponibilidad" style="display: none;">
                                                <div class="alert alert-info">
                                                    <h6><i class="fas fa-info-circle me-2"></i>Resultados de la b√∫squeda:</h6>
                                                    <div id="disponibilidadResultados"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Calendario Visual -->
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body p-0">
                                        <!-- Vista Mensual -->
                                        <div id="vistaMensual" class="calendario-vista">
                                            <!-- Header del calendario -->
                                                            <div class="calendario-header">
                    <div class="calendario-dia-header">Lun</div>
                    <div class="calendario-dia-header">Mar</div>
                    <div class="calendario-dia-header">Mi√©</div>
                    <div class="calendario-dia-header">Jue</div>
                    <div class="calendario-dia-header">Vie</div>
                    <div class="calendario-dia-header">S√°b</div>
                    <div class="calendario-dia-header">Dom</div>
                </div>
                                            
                                            <!-- Grid principal del calendario -->
                                            <div id="calendarioMensual" class="calendario-grid">
                                                <!-- Se llena din√°micamente -->
                                            </div>
                                        </div>

                                        <!-- Vista Semanal -->
                                        <div id="vistaSemanal" class="calendario-vista" style="display: none;">
                                            <div class="calendario-header" style="display: grid !important; grid-template-columns: 80px repeat(7, 1fr) !important; width: 100% !important; min-width: 800px !important;">
                                                <div class="calendario-hora-header">Hora</div>
                                                <div class="calendario-dia-header">Lun</div>
                                                <div class="calendario-dia-header">Mar</div>
                                                <div class="calendario-dia-header">Mi√©</div>
                                                <div class="calendario-dia-header">Jue</div>
                                                <div class="calendario-dia-header">Vie</div>
                                                <div class="calendario-dia-header">S√°b</div>
                                                <div class="calendario-dia-header">Dom</div>
                                            </div>
                                                                                         <div id="calendarioSemanal" class="calendario-grid-semanal" style="display: grid !important; grid-template-columns: 80px repeat(7, 1fr) !important; grid-template-rows: repeat(13, 80px) !important; width: 100% !important; min-width: 800px !important; min-height: 1040px; gap: 0;">
                                                <!-- Se llena din√°micamente -->
                                            </div>
                                        </div>

                                        <!-- Vista Diaria -->
                                        <div id="vistaDiaria" class="calendario-vista" style="display: none;">
                                            <div class="calendario-header" style="display: grid !important; grid-template-columns: 80px 1fr !important; width: 100% !important; min-width: 800px !important;">
                                                <div class="calendario-hora-header">Hora</div>
                                                <div class="calendario-dia-header" id="calendarioDiaTitulo">Lunes, 18 de Agosto</div>
                                            </div>
                                            <div id="calendarioDiario" class="calendario-grid-diario" style="display: grid !important; grid-template-columns: 80px 1fr !important; width: 100% !important; min-width: 800px !important; min-height: 800px; gap: 0;">
                                                <!-- Se llena din√°micamente -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Panel de Informaci√≥n de Reserva (mantenido para compatibilidad) -->
                        <div class="row mt-4" id="panelInfoReserva" style="display: none;">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="fas fa-info-circle me-2"></i>Informaci√≥n de Reserva</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="infoReservaDetalle">
                                            <!-- Se llena din√°micamente -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Services Tab -->
                <div class="tab-pane fade" id="services" role="tabpanel">
                    <h3 class="mb-4"><i class="fas fa-concierge-bell me-2"></i>Gesti√≥n de Servicios</h3>

                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h5><i class="fas fa-list me-2"></i>Servicios Disponibles</h5>
                                </div>
                                <div class="card-body">
                                    <div id="servicesContainer">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Cargando servicios...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5><i class="fas fa-plus me-2"></i>Nuevo Servicio</h5>
                                </div>
                                <div class="card-body">
                                    <form id="newServiceForm">
                                        <div class="mb-3">
                                            <label for="newServiceName" class="form-label">Nombre del Servicio</label>
                                            <input type="text" class="form-control" id="newServiceName" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newServiceDescription" class="form-label">Descripci√≥n</label>
                                            <textarea class="form-control" id="newServiceDescription"
                                                rows="3"></textarea>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newServiceDuration" class="form-label">Duraci√≥n (minutos)</label>
                                            <input type="number" class="form-control" id="newServiceDuration"
                                                min="1" value="60" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newServiceBasePrice" class="form-label">Precio Base (‚Ç¨)</label>
                                            <input type="number" class="form-control" id="newServiceBasePrice"
                                                step="0.01" min="0" required>
                                        </div>
                                        <button type="submit" class="btn btn-success w-100">
                                            <i class="fas fa-plus me-2"></i>Crear Servicio
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resources Tab -->
                <div class="tab-pane fade" id="resources" role="tabpanel">
                    <h3 class="mb-4"><i class="fas fa-building me-2"></i>Gesti√≥n de Recursos</h3>

                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h5><i class="fas fa-list me-2"></i>Recursos Disponibles</h5>
                                </div>
                                <div class="card-body">
                                    <div id="resourcesContainer">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Cargando recursos...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5><i class="fas fa-plus me-2"></i>Nuevo Recurso</h5>
                                </div>
                                <div class="card-body text-center">
                                    <p class="text-muted mb-3">Haz clic en el bot√≥n para crear un nuevo recurso</p>
                                    <button type="button" class="btn btn-success btn-lg" onclick="app.abrirModal('newResourceModal')">
                                        <i class="fas fa-plus me-2"></i>Crear Nuevo Recurso
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                <!-- Reservas Tab -->
                <div class="tab-pane fade" id="reservas" role="tabpanel">
                    <h3 class="mb-4"><i class="fas fa-calendar-check me-2"></i>Gesti√≥n de Reservas</h3>

                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h5><i class="fas fa-list me-2"></i>Reservas Existentes</h5>
                                </div>
                                <div class="card-body">
                                    <div id="reservasContainer">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
                                            <p>Cargando reservas...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5><i class="fas fa-plus me-2"></i><span id="reservaFormTitle">Nueva Reserva</span></h5>
                                </div>
                                <div class="card-body">
                                    <form id="newReservaForm">
                                        <!-- Campo para mostrar ID de reserva en edici√≥n -->
                                        <div class="mb-3" id="reservaIdField" style="display: none;">
                                            <label class="form-label">ID de Reserva</label>
                                            <input type="text" class="form-control" id="reservaIdDisplay" readonly>
                                            <div class="form-text text-muted">Editando reserva #<span id="reservaIdNumber"></span></div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaCliente" class="form-label">Cliente</label>
                                            <select class="form-select" id="newReservaCliente" required>
                                                <option value="">Seleccionar cliente...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaServicio" class="form-label">Servicio</label>
                                            <select class="form-select" id="newReservaServicio" required>
                                                <option value="">Seleccionar servicio...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaRecurso" class="form-label">Recurso</label>
                                            <select class="form-select" id="newReservaRecurso" required>
                                                <option value="">Seleccionar recurso...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaFechaInicio" class="form-label">Fecha y Hora de Inicio</label>
                                            <input type="datetime-local" class="form-control" id="newReservaFechaInicio" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaFechaFin" class="form-label">Fecha y Hora de Fin</label>
                                            <input type="datetime-local" class="form-control" id="newReservaFechaFin" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="newReservaEstado" class="form-label">Estado</label>
                                            <select class="form-select" id="newReservaEstado" required>
                                                <option value="confirmada">Confirmada</option>
                                                <option value="pendiente">Pendiente</option>
                                                <option value="cancelada">Cancelada</option>
                                                <option value="completada">Completada</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-success w-100">
                                            <i class="fas fa-plus me-2"></i><span id="reservaFormButtonText">Crear Reserva</span>
                                        </button>
                                    </form>
                                    
                                    <!-- √Årea de mensajes -->
                                    <div id="reservaMessageArea" class="mt-3" style="display: none;">
                                        <div class="alert" id="reservaMessage" role="alert">
                                            <span id="reservaMessageText"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filtros y B√∫squeda -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h5><i class="fas fa-search me-2"></i>Filtros y B√∫squeda</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="filterFechaInicio" class="form-label">Fecha Inicio</label>
                                            <input type="date" class="form-control" id="filterFechaInicio">
                                        </div>
                                        <div class="col-md-3">
                                            <label for="filterFechaFin" class="form-label">Fecha Fin</label>
                                            <input type="date" class="form-control" id="filterFechaFin">
                                        </div>
                                        <div class="col-md-2">
                                            <label for="filterEstado" class="form-label">Estado</label>
                                            <select class="form-select" id="filterEstado">
                                                <option value="">Todos</option>
                                                <option value="confirmada">Confirmada</option>
                                                <option value="pendiente">Pendiente</option>
                                                <option value="cancelada">Cancelada</option>
                                                <option value="completada">Completada</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label for="filterServicio" class="form-label">Servicio</label>
                                            <select class="form-select" id="filterServicio">
                                                <option value="">Todos</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <button class="btn btn-primary w-100" id="btnFiltrarReservas" style="margin-top: 32px;">
                                                <i class="fas fa-search me-2"></i>Filtrar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab de Pagos -->
        <div class="tab-pane fade" id="pagos" role="tabpanel" aria-labelledby="pagos-tab">
            <div class="container mt-4">
                <h2>üí≥ Gesti√≥n de Pagos</h2>
                <p>Gestiona pagos, facturas y reembolsos del sistema.</p>
                
                <!-- Botones de acci√≥n -->
                <div class="row mb-4">
                    <div class="col-md-12">
                        <button class="btn btn-primary me-2" onclick="abrirModal('nuevoPagoModal')">
                            <i class="fas fa-plus"></i> Nuevo Pago
                        </button>
                        <button class="btn btn-success me-2" onclick="abrirModal('nuevaFacturaModal')">
                            <i class="fas fa-file-invoice"></i> Nueva Factura
                        </button>
                        <button class="btn btn-warning me-2" onclick="abrirModal('nuevoReembolsoModal')">
                            <i class="fas fa-undo"></i> Nuevo Reembolso
                        </button>
                        <button class="btn btn-info" onclick="cargarResumenPagos()">
                            <i class="fas fa-chart-bar"></i> Resumen
                        </button>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="row mb-3">
                    <div class="col-md-3">
                        <select class="form-select" id="filtroEstadoPago">
                            <option value="">Todos los estados</option>
                            <option value="pendiente">Pendiente</option>
                            <option value="procesando">Procesando</option>
                            <option value="completado">Completado</option>
                            <option value="fallido">Fallido</option>
                            <option value="cancelado">Cancelado</option>
                            <option value="reembolsado">Reembolsado</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="filtroMetodoPago">
                            <option value="">Todos los m√©todos</option>
                            <option value="stripe">Stripe</option>
                            <option value="paypal">PayPal</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="efectivo">Efectivo</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="date" class="form-control" id="filtroFechaDesde" placeholder="Desde">
                    </div>
                    <div class="col-md-3">
                        <input type="date" class="form-control" id="filtroFechaHasta" placeholder="Hasta">
                    </div>
                </div>

                <!-- Lista de pagos -->
                <div class="row">
                    <div class="col-md-12">
                        <div id="pagosContainer">
                            <div class="text-center">
                                <div class="spinner-border" role="status">
                                    <span class="visually-hidden">Cargando...</span>
                                </div>
                                <p>Cargando pagos...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                <!-- Tab de Integraciones -->
                <div class="tab-pane fade" id="integraciones" role="tabpanel" aria-labelledby="integraciones-tab">
                    <div class="container mt-4">
                        <h2>üîó Gesti√≥n de Integraciones</h2>
                        <p>Configura y gestiona integraciones con servicios externos.</p>
                        
                        <!-- Botones de acci√≥n -->
                        <div class="row mb-4">
                            <div class="col-md-12">
                                <button class="btn btn-primary me-2" onclick="abrirModal('nuevaIntegracionModal')">
                                    <i class="fas fa-plus"></i> Nueva Integraci√≥n
                                </button>
                                <button class="btn btn-success me-2" onclick="abrirModal('nuevoWebhookModal')">
                                    <i class="fas fa-link"></i> Nuevo Webhook
                                </button>
                                <button class="btn btn-info me-2" onclick="cargarEstadoIntegraciones()">
                                    <i class="fas fa-heartbeat"></i> Estado
                                </button>
                                <button class="btn btn-warning" onclick="procesarNotificacionesPendientes()">
                                    <i class="fas fa-paper-plane"></i> Procesar Notificaciones
                                </button>
                            </div>
                        </div>

                        <!-- Tabs de integraciones -->
                        <ul class="nav nav-tabs" id="integracionesTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="integraciones-tab" data-bs-toggle="tab" data-bs-target="#integracionesList" type="button" role="tab">
                                    <i class="fas fa-plug"></i> Integraciones
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="notificaciones-tab" data-bs-toggle="tab" data-bs-target="#notificacionesList" type="button" role="tab">
                                    <i class="fas fa-bell"></i> Notificaciones
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="webhooks-tab" data-bs-toggle="tab" data-bs-target="#webhooksList" type="button" role="tab">
                                    <i class="fas fa-link"></i> Webhooks
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="google-calendar-tab" data-bs-toggle="tab" data-bs-target="#googleCalendarList" type="button" role="tab">
                                    <i class="fas fa-calendar"></i> Google Calendar
                                </button>
                            </li>
                        </ul>

                        <!-- Contenido de las tabs -->
                        <div class="tab-content" id="integracionesTabContent">
                            <!-- Lista de integraciones -->
                            <div class="tab-pane fade show active" id="integracionesList" role="tabpanel">
                                <div id="integracionesContainer" class="mt-3">
                                    <div class="text-center">
                                        <div class="spinner-border" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p>Cargando integraciones...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Lista de notificaciones -->
                            <div class="tab-pane fade" id="notificacionesList" role="tabpanel">
                                <div id="notificacionesContainer" class="mt-3">
                                    <div class="text-center">
                                        <div class="spinner-border" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p>Cargando notificaciones...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Lista de webhooks -->
                            <div class="tab-pane fade" id="webhooksList" role="tabpanel">
                                <div id="webhooksContainer" class="mt-3">
                                    <div class="text-center">
                                        <div class="spinner-border" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p>Cargando webhooks...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Lista de Google Calendar -->
                            <div class="tab-pane fade" id="googleCalendarList" role="tabpanel">
                                <div id="googleCalendarContainer" class="mt-3">
                                    <div class="text-center">
                                        <div class="spinner-border" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p>Cargando sincronizaciones...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    </div>

    <!-- Modal para Editar Reglas -->
    <div class="modal fade" id="editRuleModal" tabindex="-1" aria-labelledby="editRuleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editRuleModalLabel">
                        <i class="fas fa-edit me-2"></i>Editar Regla de Precio
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editRuleForm">
                        <input type="hidden" id="editRuleId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editRuleName" class="form-label">Nombre de la Regla</label>
                                    <input type="text" class="form-control" id="editRuleName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editRuleType" class="form-label">Tipo de Regla</label>
                                    <select class="form-select" id="editRuleType" required>
                                        <option value="hora">Hora del D√≠a</option>
                                        <option value="dia_semana">D√≠a de la Semana</option>
                                        <option value="anticipacion">Anticipaci√≥n</option>
                                        <option value="duracion">Duraci√≥n</option>
                                        <option value="participantes">Participantes</option>
                                        <option value="tipo_cliente">Tipo de Cliente</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="editRuleModifierType" class="form-label">Tipo de Modificador</label>
                                    <select class="form-select" id="editRuleModifierType" required>
                                        <option value="porcentaje">Porcentaje (%)</option>
                                        <option value="monto_fijo">Monto Fijo (‚Ç¨)</option>
                                        <option value="precio_fijo">Precio Fijo (‚Ç¨)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editRuleModifierValue" class="form-label">Valor del Modificador</label>
                                    <input type="number" class="form-control" id="editRuleModifierValue" step="0.01"
                                        required>
                                </div>
                                <div class="mb-3">
                                    <label for="editRulePriority" class="form-label">Prioridad</label>
                                    <input type="number" class="form-control" id="editRulePriority" min="1" max="100"
                                        value="10" required>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="editRuleActive" checked>
                                        <label class="form-check-label" for="editRuleActive">
                                            Regla Activa
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editRuleCondition" class="form-label">Condici√≥n (JSON)</label>
                            <textarea class="form-control" id="editRuleCondition" rows="4"
                                placeholder='Ej: {"hora_inicio": "17:00", "hora_fin": "20:00", "dias": [0,1,2,3,4]}'></textarea>
                            <small class="form-text text-muted">Formato JSON para la condici√≥n espec√≠fica de la
                                regla</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="app.saveEditedRule()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Servicios -->
    <div class="modal fade" id="editServiceModal" tabindex="-1" aria-labelledby="editServiceModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editServiceModalLabel">
                        <i class="fas fa-edit me-2"></i>Editar Servicio
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editServiceForm">
                        <input type="hidden" id="editServiceId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editServiceName" class="form-label">Nombre del Servicio</label>
                                    <input type="text" class="form-control" id="editServiceName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editServiceDescription" class="form-label">Descripci√≥n</label>
                                    <textarea class="form-control" id="editServiceDescription" rows="3"></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editServiceDuration" class="form-label">Duraci√≥n (minutos)</label>
                                    <input type="number" class="form-control" id="editServiceDuration" min="1" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editServiceBasePrice" class="form-label">Precio Base (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="editServiceBasePrice" step="0.01"
                                        min="0" required>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="app.saveEditedService()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Recursos -->
    <div class="modal fade" id="editResourceModal" tabindex="-1" aria-labelledby="editResourceModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editResourceModalLabel">
                        <i class="fas fa-edit me-2"></i>Editar Recurso
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editResourceForm">
                        <input type="hidden" id="editResourceId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editResourceName" class="form-label">Nombre del Recurso</label>
                                    <input type="text" class="form-control" id="editResourceName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editResourceType" class="form-label">Tipo de Recurso</label>
                                    <select class="form-select" id="editResourceType" required>
                                        <option value="habitacion">Habitaci√≥n</option>
                                        <option value="sala">Sala</option>
                                        <option value="equipamiento">Equipamiento</option>
                                        <option value="vehiculo">Veh√≠culo</option>
                                        <option value="otros">Otros</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="editResourcePrice" class="form-label">Precio Base (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="editResourcePrice" step="0.01" min="0" placeholder="0.00">
                                    <div class="form-text">Precio base por hora/uso del recurso</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editResourceCapacity" class="form-label">Capacidad</label>
                                    <input type="number" class="form-control" id="editResourceCapacity" min="1"
                                        value="1">
                                </div>
                                <div class="mb-3">
                                    <label for="editResourceDescription" class="form-label">Descripci√≥n</label>
                                    <textarea class="form-control" id="editResourceDescription" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="editResourceAvailable" checked>
                                <label class="form-check-label" for="editResourceAvailable">
                                    Disponible
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="app.saveEditedResource()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Crear Reserva desde Calendario -->
    <div class="modal fade" id="calendarioReservaModal" tabindex="-1" aria-labelledby="calendarioReservaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="calendarioReservaModalLabel">
                        <i class="fas fa-calendar-plus me-2"></i>Nueva Reserva desde Calendario
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Informaci√≥n del per√≠odo seleccionado -->
                        <div class="col-12 mb-4">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Per√≠odo seleccionado:</strong> 
                                <span id="periodoSeleccionado"></span>
                            </div>
                        </div>
                        
                        <!-- Formulario de reserva -->
                        <div class="col-12">
                            <form id="calendarioReservaForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="calendarioReservaCliente" class="form-label">Cliente</label>
                                            <select class="form-select" id="calendarioReservaCliente" required>
                                                <option value="">Seleccionar cliente...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calendarioReservaServicio" class="form-label">Servicio</label>
                                            <select class="form-select" id="calendarioReservaServicio" required>
                                                <option value="">Seleccionar servicio...</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calendarioReservaRecurso" class="form-label">Recurso</label>
                                            <select class="form-select" id="calendarioReservaRecurso" required>
                                                <option value="">Seleccionar recurso...</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="calendarioReservaFechaInicio" class="form-label">Fecha y Hora de Inicio</label>
                                            <input type="datetime-local" class="form-control" id="calendarioReservaFechaInicio" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calendarioReservaFechaFin" class="form-label">Fecha y Hora de Fin</label>
                                            <div class="input-group">
                                                <input type="datetime-local" class="form-control" id="calendarioReservaFechaFin" required>
                                                <button type="button" class="btn btn-outline-primary" onclick="app.calcularFechaFinDesdeServicio()" title="Recalcular fecha de fin bas√°ndose en el servicio seleccionado">
                                                    <i class="fas fa-calculator"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="calendarioReservaEstado" class="form-label">Estado</label>
                                            <select class="form-select" id="calendarioReservaEstado" required>
                                                <option value="confirmada">Confirmada</option>
                                                <option value="pendiente">Pendiente</option>
                                                <option value="cancelada">Cancelada</option>
                                                <option value="completada">Completada</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Opciones de reserva m√∫ltiple -->
                                <div class="row mt-3">
                                    <div class="col-12">
                                        <div class="card border-primary">
                                            <div class="card-header bg-primary text-white">
                                                <h6 class="mb-0"><i class="fas fa-calendar-week me-2"></i>Opciones de Reserva M√∫ltiple</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="reservaMultipleDias">
                                                            <label class="form-check-label" for="reservaMultipleDias">
                                                                Reserva de m√∫ltiples d√≠as
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="reservaRecurrente">
                                                            <label class="form-check-label" for="reservaRecurrente">
                                                                Reserva recurrente
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="checkbox" id="reservaBloque">
                                                            <label class="form-check-label" for="reservaBloque">
                                                                Bloquear per√≠odo completo
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Configuraci√≥n de reserva m√∫ltiple -->
                                                <div id="configuracionMultiple" class="mt-3" style="display: none;">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <label for="diasAdicionales" class="form-label">D√≠as adicionales</label>
                                                            <input type="number" class="form-control" id="diasAdicionales" min="1" max="30" value="1">
                                                        </div>
                                                        <div class="col-md-6">
                                                            <label for="tipoRecurrencia" class="form-label">Tipo de recurrencia</label>
                                                            <select class="form-select" id="tipoRecurrencia">
                                                                <option value="diaria">Diaria</option>
                                                                <option value="semanal">Semanal</option>
                                                                <option value="mensual">Mensual</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- √Årea de mensajes -->
                    <div id="calendarioReservaMessageArea" class="mt-3" style="display: none;">
                        <div class="alert" id="calendarioReservaMessage" role="alert">
                            <span id="calendarioReservaMessageText"></span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="app.crearReservaDesdeCalendario()">
                        <i class="fas fa-calendar-plus me-2"></i>Crear Reserva
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Informaci√≥n de Reserva -->
    <div class="modal fade" id="infoReservaModal" tabindex="-1" aria-labelledby="infoReservaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="infoReservaModalLabel">
                        <i class="fas fa-info-circle me-2"></i>Informaci√≥n de Reserva
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="infoReservaDetalleModal">
                        <!-- Se llena din√°micamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edici√≥n de Reserva -->
    <div class="modal fade" id="editReservaModal" tabindex="-1" aria-labelledby="editReservaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editReservaModalLabel">
                        <i class="fas fa-edit me-2"></i>Editar Reserva
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editReservaForm">
                        <input type="hidden" id="editReservaId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editReservaCliente" class="form-label">Cliente</label>
                                    <select class="form-select" id="editReservaCliente" required>
                                        <option value="">Seleccionar cliente...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="editReservaServicio" class="form-label">Servicio</label>
                                    <select class="form-select" id="editReservaServicio" required>
                                        <option value="">Seleccionar servicio...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="editReservaRecurso" class="form-label">Recurso</label>
                                    <select class="form-select" id="editReservaRecurso" required>
                                        <option value="">Seleccionar recurso...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editReservaFechaInicio" class="form-label">Fecha y Hora de Inicio</label>
                                    <input type="datetime-local" class="form-control" id="editReservaFechaInicio" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editReservaFechaFin" class="form-label">Fecha y Hora de Fin</label>
                                    <input type="datetime-local" class="form-control" id="editReservaFechaFin" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editReservaEstado" class="form-label">Estado</label>
                                    <select class="form-select" id="editReservaEstado" required>
                                        <option value="confirmada">Confirmada</option>
                                        <option value="pendiente">Pendiente</option>
                                        <option value="cancelada">Cancelada</option>
                                        <option value="completada">Completada</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="app.saveEditedReserva()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Creaci√≥n de Recurso -->
    <div class="modal fade" id="newResourceModal" tabindex="-1" aria-labelledby="newResourceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newResourceModalLabel">
                        <i class="fas fa-plus me-2"></i>Crear Nuevo Recurso
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="newResourceForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newResourceName" class="form-label">Nombre del Recurso</label>
                                    <input type="text" class="form-control" id="newResourceName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="newResourceType" class="form-label">Tipo de Recurso</label>
                                    <select class="form-select" id="newResourceType" required>
                                        <option value="">Seleccionar tipo...</option>
                                        <option value="habitacion">Habitaci√≥n</option>
                                        <option value="sala">Sala</option>
                                        <option value="equipamiento">Equipamiento</option>
                                        <option value="vehiculo">Veh√≠culo</option>
                                        <option value="otros">Otros</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="newResourcePrice" class="form-label">Precio Base (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="newResourcePrice" step="0.01" min="0" placeholder="0.00">
                                    <div class="form-text">Precio base por hora/uso del recurso</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newResourceCapacity" class="form-label">Capacidad</label>
                                    <input type="number" class="form-control" id="newResourceCapacity" min="1" value="1">
                                </div>
                                <div class="mb-3">
                                    <label for="newResourceDescription" class="form-label">Descripci√≥n</label>
                                    <textarea class="form-control" id="newResourceDescription" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="newResourceAvailable" checked>
                                <label class="form-check-label" for="newResourceAvailable">
                                    Disponible
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-success" onclick="app.createNewResource()">
                        <i class="fas fa-plus me-2"></i>Crear Recurso
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Informaci√≥n de Recurso -->
    <div class="modal fade" id="infoResourceModal" tabindex="-1" aria-labelledby="infoResourceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="infoResourceModalLabel">
                        <i class="fas fa-building me-2"></i>Informaci√≥n del Recurso
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="infoResourceDetalleModal">
                        <!-- Se llena din√°micamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Gesti√≥n de Precios del Recurso -->
    <div class="modal fade" id="resourcePricingModal" tabindex="-1" aria-labelledby="resourcePricingModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="resourcePricingModalLabel">
                        <i class="fas fa-euro-sign me-2"></i>Gesti√≥n de Precios del Recurso
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Informaci√≥n del recurso -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Recurso:</strong> <span id="resourcePricingName"></span>
                                <br>
                                <strong>Precio Base Actual:</strong> ‚Ç¨<span id="resourcePricingBasePrice"></span>/hora
                            </div>
                        </div>
                    </div>

                    <!-- Tabs para diferentes tipos de precios -->
                    <ul class="nav nav-tabs" id="resourcePricingTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="precio-base-tab" data-bs-toggle="tab" data-bs-target="#precio-base" type="button" role="tab">
                                <i class="fas fa-tag me-2"></i>Precio Base
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="precio-hora-tab" data-bs-toggle="tab" data-bs-target="#precio-hora" type="button" role="tab">
                                <i class="fas fa-clock me-2"></i>Precio por Hora
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="precio-dia-tab" data-bs-toggle="tab" data-bs-target="#precio-dia" type="button" role="tab">
                                <i class="fas fa-calendar-day me-2"></i>Precio por D√≠a
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="precio-temporada-tab" data-bs-toggle="tab" data-bs-target="#precio-temporada" type="button" role="tab">
                                <i class="fas fa-calendar-week me-2"></i>Precio por Temporada
                            </button>
                        </li>
                    </ul>

                    <!-- Contenido de los tabs -->
                    <div class="tab-content" id="resourcePricingTabContent">
                        <!-- Tab Precio Base -->
                        <div class="tab-pane fade show active" id="precio-base" role="tabpanel">
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-edit me-2"></i>Editar Precio Base</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="editResourceBasePriceForm">
                                                <div class="mb-3">
                                                    <label for="editResourceBasePrice" class="form-label">Precio Base (‚Ç¨/hora)</label>
                                                    <input type="number" class="form-control" id="editResourceBasePrice" step="0.01" min="0" required>
                                                    <div class="form-text">Precio base por hora de uso del recurso</div>
                                                </div>
                                                <button type="submit" class="btn btn-primary">
                                                    <i class="fas fa-save me-2"></i>Actualizar Precio Base
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-info-circle me-2"></i>Informaci√≥n del Precio Base</h6>
                                        </div>
                                        <div class="card-body">
                                            <p><strong>Uso:</strong> Este precio se aplica como base para todas las reservas del recurso.</p>
                                            <p><strong>Modificaci√≥n:</strong> Los precios din√°micos pueden modificar este valor base.</p>
                                            <p><strong>Facturaci√≥n:</strong> Se calcula por hora de uso efectivo.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Precio por Hora -->
                        <div class="tab-pane fade" id="precio-hora" role="tabpanel">
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-plus me-2"></i>Nueva Regla de Precio por Hora</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="newResourceHourlyPriceForm">
                                                <div class="mb-3">
                                                    <label for="newResourceHourlyPriceName" class="form-label">Nombre de la Regla</label>
                                                    <input type="text" class="form-control" id="newResourceHourlyPriceName" placeholder="Ej: Hora Pico" required>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label for="newResourceHourlyPriceStart" class="form-label">Hora Inicio</label>
                                                            <input type="time" class="form-control" id="newResourceHourlyPriceStart" required>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label for="newResourceHourlyPriceEnd" class="form-label">Hora Fin</label>
                                                            <input type="time" class="form-control" id="newResourceHourlyPriceEnd" required>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceHourlyPriceModifier" class="form-label">Modificador de Precio</label>
                                                    <select class="form-select" id="newResourceHourlyPriceModifier" required>
                                                        <option value="">Seleccionar tipo...</option>
                                                        <option value="porcentaje">Porcentaje (%)</option>
                                                        <option value="monto_fijo">Monto Fijo (‚Ç¨)</option>
                                                        <option value="precio_fijo">Precio Fijo (‚Ç¨)</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceHourlyPriceValue" class="form-label">Valor del Modificador</label>
                                                    <input type="number" class="form-control" id="newResourceHourlyPriceValue" step="0.01" required>
                                                    <div class="form-text">Valor del modificador (%, ‚Ç¨, o precio fijo)</div>
                                                </div>
                                                <button type="submit" class="btn btn-success">
                                                    <i class="fas fa-plus me-2"></i>Crear Regla de Precio
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-list me-2"></i>Reglas de Precio por Hora Activas</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="resourceHourlyPriceRules">
                                                <div class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i>
                                                    <p>Cargando reglas...</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Precio por D√≠a -->
                        <div class="tab-pane fade" id="precio-dia" role="tabpanel">
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-plus me-2"></i>Nueva Regla de Precio por D√≠a</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="newResourceDailyPriceForm">
                                                <div class="mb-3">
                                                    <label for="newResourceDailyPriceName" class="form-label">Nombre de la Regla</label>
                                                    <input type="text" class="form-control" id="newResourceDailyPriceName" placeholder="Ej: Fin de Semana" required>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceDailyPriceDays" class="form-label">D√≠as de la Semana</label>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceMonday" value="1">
                                                        <label class="form-check-label" for="newResourceDailyPriceMonday">Lunes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceTuesday" value="2">
                                                        <label class="form-check-label" for="newResourceDailyPriceTuesday">Martes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceWednesday" value="3">
                                                        <label class="form-check-label" for="newResourceDailyPriceWednesday">Mi√©rcoles</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceThursday" value="4">
                                                        <label class="form-check-label" for="newResourceDailyPriceThursday">Jueves</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceFriday" value="5">
                                                        <label class="form-check-label" for="newResourceDailyPriceFriday">Viernes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceSaturday" value="6">
                                                        <label class="form-check-label" for="newResourceDailyPriceSaturday">S√°bado</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="newResourceDailyPriceSunday" value="0">
                                                        <label class="form-check-label" for="newResourceDailyPriceSunday">Domingo</label>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceDailyPriceModifier" class="form-label">Modificador de Precio</label>
                                                    <select class="form-select" id="newResourceDailyPriceModifier" required>
                                                        <option value="">Seleccionar tipo...</option>
                                                        <option value="porcentaje">Porcentaje (%)</option>
                                                        <option value="monto_fijo">Monto Fijo (‚Ç¨)</option>
                                                        <option value="precio_fijo">Precio Fijo (‚Ç¨)</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceDailyPriceValue" class="form-label">Valor del Modificador</label>
                                                    <input type="number" class="form-control" id="newResourceDailyPriceValue" step="0.01" required>
                                                </div>
                                                <button type="submit" class="btn btn-success">
                                                    <i class="fas fa-plus me-2"></i>Crear Regla de Precio
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-list me-2"></i>Reglas de Precio por D√≠a Activas</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="resourceDailyPriceRules">
                                                <div class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i>
                                                    <p>Cargando reglas...</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Precio por Temporada -->
                        <div class="tab-pane fade" id="precio-temporada" role="tabpanel">
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-plus me-2"></i>Nueva Regla de Precio por Temporada</h6>
                                        </div>
                                        <div class="card-body">
                                            <form id="newResourceSeasonalPriceForm">
                                                <div class="mb-3">
                                                    <label for="newResourceSeasonalPriceName" class="form-label">Nombre de la Regla</label>
                                                    <input type="text" class="form-control" id="newResourceSeasonalPriceName" placeholder="Ej: Temporada Alta" required>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label for="newResourceSeasonalPriceStart" class="form-label">Fecha Inicio</label>
                                                            <input type="date" class="form-control" id="newResourceSeasonalPriceStart" required>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label for="newResourceSeasonalPriceEnd" class="form-label">Fecha Fin</label>
                                                            <input type="date" class="form-control" id="newResourceSeasonalPriceEnd" required>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceSeasonalPriceModifier" class="form-label">Modificador de Precio</label>
                                                    <select class="form-select" id="newResourceSeasonalPriceModifier" required>
                                                        <option value="">Seleccionar tipo...</option>
                                                        <option value="porcentaje">Porcentaje (%)</option>
                                                        <option value="monto_fijo">Monto Fijo (‚Ç¨)</option>
                                                        <option value="precio_fijo">Precio Fijo (‚Ç¨)</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="newResourceSeasonalPriceValue" class="form-label">Valor del Modificador</label>
                                                    <input type="number" class="form-control" id="newResourceSeasonalPriceValue" step="0.01" required>
                                                </div>
                                                <button type="submit" class="btn btn-success">
                                                    <i class="fas fa-plus me-2"></i>Crear Regla de Precio
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-list me-2"></i>Reglas de Precio por Temporada Activas</h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="resourceSeasonalPriceRules">
                                                <div class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i>
                                                    <p>Cargando reglas...</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>

                <!-- Tab de Precios -->
                <div class="tab-pane fade" id="precios" role="tabpanel" aria-labelledby="precios-tab">
                    <div class="container mt-4">
                        <h2>üí∞ Gesti√≥n de Precios</h2>
                        <p>Configura y gestiona precios para servicios y recursos.</p>
                        
                        <!-- Botones de acci√≥n -->
                        <div class="row mb-4">
                            <div class="col-md-12">
                                <button class="btn btn-primary me-2" onclick="abrirModal('nuevoPrecioModal')">
                                    <i class="fas fa-plus"></i> Nuevo Precio
                                </button>
                                <button class="btn btn-info me-2" onclick="cargarEstadisticasPrecios()">
                                    <i class="fas fa-chart-bar"></i> Estad√≠sticas
                                </button>
                                <button class="btn btn-success me-2" onclick="abrirCalculadoraPrecios()">
                                    <i class="fas fa-calculator"></i> Calculadora
                                </button>
                                <button class="btn btn-warning" onclick="cargarPrecios()">
                                    <i class="fas fa-sync"></i> Actualizar
                                </button>
                            </div>
                        </div>

                        <!-- Filtros de precios -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5><i class="fas fa-filter me-2"></i>Filtros de Precios</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="filtroTipoPrecio" class="form-label">Tipo de Precio</label>
                                        <select class="form-select" id="filtroTipoPrecio" onchange="aplicarFiltrosPrecios()">
                                            <option value="">Todos los tipos</option>
                                            <option value="base">Base</option>
                                            <option value="descuento">Descuento</option>
                                            <option value="recargo">Recargo</option>
                                            <option value="hora">Por Hora</option>
                                            <option value="dia">Por D√≠a</option>
                                            <option value="temporada">Temporada</option>
                                            <option value="grupo">Grupo</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="filtroMoneda" class="form-label">Moneda</label>
                                        <select class="form-select" id="filtroMoneda" onchange="aplicarFiltrosPrecios()">
                                            <option value="">Todas las monedas</option>
                                            <option value="EUR">EUR</option>
                                            <option value="USD">USD</option>
                                            <option value="GBP">GBP</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="filtroEstado" class="form-label">Estado</label>
                                        <select class="form-select" id="filtroEstado" onchange="aplicarFiltrosPrecios()">
                                            <option value="">Todos los estados</option>
                                            <option value="true">Activo</option>
                                            <option value="false">Inactivo</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="filtroRangoPrecio" class="form-label">Rango de Precio</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="filtroPrecioMin" placeholder="Min" onchange="aplicarFiltrosPrecios()">
                                            <span class="input-group-text">-</span>
                                            <input type="number" class="form-control" id="filtroPrecioMax" placeholder="Max" onchange="aplicarFiltrosPrecios()">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Lista de precios -->
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-list me-2"></i>Lista de Precios</h5>
                            </div>
                            <div class="card-body">
                                <div id="preciosContainer">
                                    <div class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2">Cargando precios...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Dashboard de estad√≠sticas -->
                        <div class="row mt-4" id="estadisticasPreciosContainer" style="display: none;">
                            <div class="col-md-3">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <h5 class="card-title text-primary">
                                            <i class="fas fa-tag me-2"></i>Total Precios
                                        </h5>
                                        <h3 id="totalPrecios" class="text-primary">-</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <h5 class="card-title text-success">
                                            <i class="fas fa-check-circle me-2"></i>Activos
                                        </h5>
                                        <h3 id="preciosActivos" class="text-success">-</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <h5 class="card-title text-info">
                                            <i class="fas fa-euro-sign me-2"></i>Precio Promedio
                                        </h5>
                                        <h3 id="precioPromedio" class="text-info">-</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card text-center">
                                    <div class="card-body">
                                        <h5 class="card-title text-warning">
                                            <i class="fas fa-chart-line me-2"></i>Rango
                                        </h5>
                                        <h3 id="rangoPrecio" class="text-warning">-</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- ======================================== -->
    <!-- MODALES PARA GESTI√ìN DE PAGOS -->
    <!-- ======================================== -->

    <!-- Modal Nuevo Pago -->
    <div class="modal fade" id="nuevoPagoModal" tabindex="-1" aria-labelledby="nuevoPagoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevoPagoModalLabel">
                        <i class="fas fa-plus me-2"></i>Nuevo Pago
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevoPagoForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPagoReserva" class="form-label">Reserva</label>
                                    <select class="form-select" id="nuevoPagoReserva" required>
                                        <option value="">Seleccionar reserva...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoPagoCliente" class="form-label">Cliente</label>
                                    <select class="form-select" id="nuevoPagoCliente" required>
                                        <option value="">Seleccionar cliente...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoPagoMonto" class="form-label">Monto (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="nuevoPagoMonto" step="0.01" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPagoMetodo" class="form-label">M√©todo de Pago</label>
                                    <select class="form-select" id="nuevoPagoMetodo" required>
                                        <option value="">Seleccionar m√©todo...</option>
                                        <option value="stripe">Stripe</option>
                                        <option value="paypal">PayPal</option>
                                        <option value="transferencia">Transferencia</option>
                                        <option value="efectivo">Efectivo</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoPagoMoneda" class="form-label">Moneda</label>
                                    <select class="form-select" id="nuevoPagoMoneda" required>
                                        <option value="EUR">EUR (‚Ç¨)</option>
                                        <option value="USD">USD ($)</option>
                                        <option value="GBP">GBP (¬£)</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoPagoDescripcion" class="form-label">Descripci√≥n</label>
                                    <textarea class="form-control" id="nuevoPagoDescripcion" rows="3" placeholder="Descripci√≥n del pago..."></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevoPago()">
                        <i class="fas fa-save me-2"></i>Crear Pago
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nueva Factura -->
    <div class="modal fade" id="nuevaFacturaModal" tabindex="-1" aria-labelledby="nuevaFacturaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevaFacturaModalLabel">
                        <i class="fas fa-file-invoice me-2"></i>Nueva Factura
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevaFacturaForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevaFacturaPago" class="form-label">Pago Asociado</label>
                                    <select class="form-select" id="nuevaFacturaPago" required>
                                        <option value="">Seleccionar pago...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaFacturaCliente" class="form-label">Cliente</label>
                                    <select class="form-select" id="nuevaFacturaCliente" required>
                                        <option value="">Seleccionar cliente...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaFacturaSubtotal" class="form-label">Subtotal (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="nuevaFacturaSubtotal" step="0.01" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevaFacturaIVA" class="form-label">IVA (%)</label>
                                    <input type="number" class="form-control" id="nuevaFacturaIVA" step="0.01" min="0" value="21" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaFacturaTotal" class="form-label">Total (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="nuevaFacturaTotal" step="0.01" min="0" readonly>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaFacturaVencimiento" class="form-label">Fecha de Vencimiento</label>
                                    <input type="date" class="form-control" id="nuevaFacturaVencimiento">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevaFactura()">
                        <i class="fas fa-save me-2"></i>Crear Factura
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nuevo Reembolso -->
    <div class="modal fade" id="nuevoReembolsoModal" tabindex="-1" aria-labelledby="nuevoReembolsoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevoReembolsoModalLabel">
                        <i class="fas fa-undo me-2"></i>Nuevo Reembolso
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevoReembolsoForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoReembolsoPago" class="form-label">Pago a Reembolsar</label>
                                    <select class="form-select" id="nuevoReembolsoPago" required>
                                        <option value="">Seleccionar pago...</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoReembolsoMonto" class="form-label">Monto a Reembolsar (‚Ç¨)</label>
                                    <input type="number" class="form-control" id="nuevoReembolsoMonto" step="0.01" min="0" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoReembolsoMotivo" class="form-label">Motivo del Reembolso</label>
                                    <textarea class="form-control" id="nuevoReembolsoMotivo" rows="3" placeholder="Motivo del reembolso..." required></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoReembolsoAprobador" class="form-label">Aprobado por</label>
                                    <select class="form-select" id="nuevoReembolsoAprobador">
                                        <option value="">Seleccionar usuario...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevoReembolso()">
                        <i class="fas fa-save me-2"></i>Crear Reembolso
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ======================================== -->
    <!-- MODALES PARA GESTI√ìN DE INTEGRACIONES -->
    <!-- ======================================== -->

    <!-- Modal Nueva Integraci√≥n -->
    <div class="modal fade" id="nuevaIntegracionModal" tabindex="-1" aria-labelledby="nuevaIntegracionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevaIntegracionModalLabel">
                        <i class="fas fa-plus me-2"></i>Nueva Integraci√≥n
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevaIntegracionForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevaIntegracionNombre" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="nuevaIntegracionNombre" placeholder="Ej: Email Marketing" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaIntegracionTipo" class="form-label">Tipo de Integraci√≥n</label>
                                    <select class="form-select" id="nuevaIntegracionTipo" required>
                                        <option value="">Seleccionar tipo...</option>
                                        <option value="email">Email</option>
                                        <option value="sms">SMS</option>
                                        <option value="whatsapp">WhatsApp</option>
                                        <option value="google_calendar">Google Calendar</option>
                                        <option value="stripe">Stripe</option>
                                        <option value="paypal">PayPal</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaIntegracionEstado" class="form-label">Estado</label>
                                    <select class="form-select" id="nuevaIntegracionEstado" required>
                                        <option value="configurando">Configurando</option>
                                        <option value="activa">Activa</option>
                                        <option value="inactiva">Inactiva</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevaIntegracionDescripcion" class="form-label">Descripci√≥n</label>
                                    <textarea class="form-control" id="nuevaIntegracionDescripcion" rows="3" placeholder="Descripci√≥n de la integraci√≥n..."></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaIntegracionWebhook" class="form-label">URL del Webhook</label>
                                    <input type="url" class="form-control" id="nuevaIntegracionWebhook" placeholder="https://webhook.site/...">
                                </div>
                                <div class="mb-3">
                                    <label for="nuevaIntegracionConfig" class="form-label">Configuraci√≥n (JSON)</label>
                                    <textarea class="form-control" id="nuevaIntegracionConfig" rows="3" placeholder='{"api_key": "..."}'></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevaIntegracion()">
                        <i class="fas fa-save me-2"></i>Crear Integraci√≥n
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nuevo Webhook -->
    <div class="modal fade" id="nuevoWebhookModal" tabindex="-1" aria-labelledby="nuevoWebhookModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevoWebhookModalLabel">
                        <i class="fas fa-link me-2"></i>Nuevo Webhook
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevoWebhookForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoWebhookNombre" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="nuevoWebhookNombre" placeholder="Ej: Webhook de Prueba" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoWebhookURL" class="form-label">URL del Webhook</label>
                                    <input type="url" class="form-control" id="nuevoWebhookURL" placeholder="https://webhook.site/..." required>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoWebhookEvento" class="form-label">Evento</label>
                                    <select class="form-select" id="nuevoWebhookEvento" required>
                                        <option value="">Seleccionar evento...</option>
                                        <option value="reserva_creada">Reserva Creada</option>
                                        <option value="reserva_actualizada">Reserva Actualizada</option>
                                        <option value="reserva_cancelada">Reserva Cancelada</option>
                                        <option value="pago_completado">Pago Completado</option>
                                        <option value="pago_fallido">Pago Fallido</option>
                                        <option value="factura_generada">Factura Generada</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoWebhookMetodo" class="form-label">M√©todo HTTP</label>
                                    <select class="form-select" id="nuevoWebhookMetodo" required>
                                        <option value="POST">POST</option>
                                        <option value="PUT">PUT</option>
                                        <option value="PATCH">PATCH</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="nuevoWebhookSecret" class="form-label">Clave Secreta</label>
                                    <input type="text" class="form-control" id="nuevoWebhookSecret" placeholder="Clave para verificar webhook">
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="nuevoWebhookSSL" checked>
                                        <label class="form-check-label" for="nuevoWebhookSSL">
                                            Verificar SSL
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevoWebhook()">
                        <i class="fas fa-save me-2"></i>Crear Webhook
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ======================================== -->
    <!-- MODALES PARA GESTI√ìN DE PRECIOS -->
    <!-- ======================================== -->

    <!-- Modal Nuevo Precio -->
    <div class="modal fade" id="nuevoPrecioModal" tabindex="-1" aria-labelledby="nuevoPrecioModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nuevoPrecioModalLabel">
                        <i class="fas fa-plus me-2"></i>Nuevo Precio
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="nuevoPrecioForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioServicio" class="form-label">Servicio (opcional)</label>
                                    <select class="form-select" id="nuevoPrecioServicio">
                                        <option value="">Seleccionar servicio...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioRecurso" class="form-label">Recurso (opcional)</label>
                                    <select class="form-select" id="nuevoPrecioRecurso">
                                        <option value="">Seleccionar recurso...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioTipo" class="form-label">Tipo de Precio</label>
                                    <select class="form-select" id="nuevoPrecioTipo" required>
                                        <option value="">Seleccionar tipo...</option>
                                        <option value="base">Base</option>
                                        <option value="descuento">Descuento</option>
                                        <option value="recargo">Recargo</option>
                                        <option value="hora">Por Hora</option>
                                        <option value="dia">Por D√≠a</option>
                                        <option value="temporada">Temporada</option>
                                        <option value="grupo">Grupo</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioMoneda" class="form-label">Moneda</label>
                                    <select class="form-select" id="nuevoPrecioMoneda" required>
                                        <option value="EUR">EUR</option>
                                        <option value="USD">USD</option>
                                        <option value="GBP">GBP</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioNombre" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="nuevoPrecioNombre" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioPrecio" class="form-label">Precio Base</label>
                                    <div class="input-group">
                                        <input type="number" step="0.01" class="form-control" id="nuevoPrecioPrecio" required>
                                        <span class="input-group-text" id="nuevoPrecioMonedaSymbol">‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="nuevoPrecioDescripcion" class="form-label">Descripci√≥n</label>
                            <textarea class="form-control" id="nuevoPrecioDescripcion" rows="2"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="nuevoPrecioPrioridad" class="form-label">Prioridad</label>
                                    <input type="number" class="form-control" id="nuevoPrecioPrioridad" value="0" min="0">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="nuevoPrecioActivo" checked>
                                    <label class="form-check-label" for="nuevoPrecioActivo">Activo</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Secci√≥n de condiciones especiales -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-cogs me-2"></i>Condiciones Especiales (Opcional)
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioFechaInicio" class="form-label">Fecha Inicio</label>
                                            <input type="datetime-local" class="form-control" id="nuevoPrecioFechaInicio">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioFechaFin" class="form-label">Fecha Fin</label>
                                            <input type="datetime-local" class="form-control" id="nuevoPrecioFechaFin">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioCantidadMin" class="form-label">Cantidad M√≠nima</label>
                                            <input type="number" class="form-control" id="nuevoPrecioCantidadMin" min="1">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioCantidadMax" class="form-label">Cantidad M√°xima</label>
                                            <input type="number" class="form-control" id="nuevoPrecioCantidadMax" min="1">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioHoraInicio" class="form-label">Hora Inicio</label>
                                            <input type="time" class="form-control" id="nuevoPrecioHoraInicio">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioHoraFin" class="form-label">Hora Fin</label>
                                            <input type="time" class="form-control" id="nuevoPrecioHoraFin">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="nuevoPrecioDiasSemana" class="form-label">D√≠as Semana</label>
                                            <input type="text" class="form-control" id="nuevoPrecioDiasSemana" placeholder="1,2,3,4,5">
                                            <small class="form-text text-muted">Ej: 1,2,3,4,5 (L-V) o 6,7 (Fin de semana)</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="crearNuevoPrecio()">
                        <i class="fas fa-save me-2"></i>Crear Precio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Calculadora de Precios -->
    <div class="modal fade" id="calculadoraPreciosModal" tabindex="-1" aria-labelledby="calculadoraPreciosModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="calculadoraPreciosModalLabel">
                        <i class="fas fa-calculator me-2"></i>Calculadora de Precios
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="calculadoraPreciosForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcServicio" class="form-label">Servicio</label>
                                    <select class="form-select" id="calcServicio">
                                        <option value="">Seleccionar servicio...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcRecurso" class="form-label">Recurso</label>
                                    <select class="form-select" id="calcRecurso">
                                        <option value="">Seleccionar recurso...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcFechaInicio" class="form-label">Fecha y Hora Inicio</label>
                                    <input type="datetime-local" class="form-control" id="calcFechaInicio" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcFechaFin" class="form-label">Fecha y Hora Fin</label>
                                    <input type="datetime-local" class="form-control" id="calcFechaFin" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcCantidad" class="form-label">Cantidad</label>
                                    <input type="number" class="form-control" id="calcCantidad" value="1" min="1" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="calcCliente" class="form-label">Cliente (para descuentos)</label>
                                    <select class="form-select" id="calcCliente">
                                        <option value="">Seleccionar cliente...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="d-grid mb-3">
                            <button type="button" class="btn btn-primary" onclick="calcularPrecioCompleto()">
                                <i class="fas fa-calculator me-2"></i>Calcular Precio
                            </button>
                        </div>
                        
                        <!-- Resultado del c√°lculo -->
                        <div id="resultadoCalculoPrecio" style="display: none;">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="fas fa-receipt me-2"></i>Resultado del C√°lculo
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="text-center">
                                                <h6 class="text-muted">Precio Base</h6>
                                                <h4 id="resultadoPrecioBase" class="text-info">-</h4>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="text-center">
                                                <h6 class="text-muted">Precio Final</h6>
                                                <h4 id="resultadoPrecioFinal" class="text-primary">-</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="desgloseCalculoPrecio" class="mt-3"></div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/app.js"></script>
    <script src="/static/precios.js"></script>
</body>

</html>